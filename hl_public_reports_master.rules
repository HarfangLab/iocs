alert tcp $EXTERNAL_NET any -> $HOME_NET [80,443,1024:] (msg:"Invalid RFC7617 Basic Auth in HTTP POST"; flow:established,to_server; content:"POST"; http_method; content:"Authorization: Basic "; http_raw_header; fast_pattern; pcre:"/\sAuthorization:\sBasic\s\w+:\w+\s/D"; threshold:type limit,track by_src,count 1,seconds 120; sid:632408011; rev:1; reference:url,https://harfanglab.io/insidethelab/; metadata: author HarfangLab,trr TRR240801;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [80,443,1024:] (msg:"Cyclops HTTP API Request"; flow:established,to_server; content:"POST"; http_method; content:"Authorization: Basic "; http_raw_header; content:"/api/v3/update"; http_raw_uri; fast_pattern; content:"name=\"resume\""; offset:34; depth:64; http_client_body; content:"\"syncresult\":"; distance:40; within:64; http_client_body; threshold:type limit,track by_src,count 1,seconds 120; sid:632408012; rev:1;reference:url,https://harfanglab.io/insidethelab/; metadata: author HarfangLab,trr TRR240801;)
